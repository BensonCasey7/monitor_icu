I0105 22:37:25.841022 140736542172096 main.py:337] Saved model parameters:
I0105 22:37:25.841255 140736542172096 main.py:339] 0: model_type=lr
I0105 22:37:25.841348 140736542172096 main.py:339] 1: input_size=256
I0105 22:37:25.841426 140736542172096 main.py:339] 2: rnn_hidden_size=256
I0105 22:37:25.841504 140736542172096 main.py:339] 3: use_attention=False
I0105 22:37:25.841579 140736542172096 main.py:339] 4: rnn_type=lstm
I0105 22:37:25.841651 140736542172096 main.py:339] 5: rnn_layers=1
I0105 22:37:25.841722 140736542172096 main.py:339] 6: rnn_dropout=0.0
I0105 22:37:25.841814 140736542172096 main.py:339] 7: rnn_bidirectional=False
I0105 22:37:25.841905 140736542172096 main.py:339] 8: standardize=True
I0105 22:37:25.841978 140736542172096 main.py:339] 9: block_size=6
I0105 22:37:25.842050 140736542172096 main.py:339] 10: history_window=8
I0105 22:37:25.842123 140736542172096 main.py:339] 11: prediction_window=2
I0105 22:37:25.842195 140736542172096 main.py:339] 12: target_label=death
I0105 22:37:25.842266 140736542172096 main.py:339] 13: data_dir=./data
I0105 22:37:25.842334 140736542172096 main.py:339] 14: lr_pooling=mean
I0105 22:37:25.842414 140736542172096 main.py:520] Mode: Training
I0105 22:37:25.842667 140736542172096 main.py:82] 0: code/main.py
I0105 22:37:25.842754 140736542172096 main.py:82] 1: --phase=train
I0105 22:37:25.842830 140736542172096 main.py:82] 2: --model_type=lr
I0105 22:37:25.842903 140736542172096 main.py:82] 3: --rnn_type=lstm
I0105 22:37:25.842971 140736542172096 main.py:82] 4: --nornn_bidirectional
I0105 22:37:25.843040 140736542172096 main.py:82] 5: --nouse_attention
I0105 22:37:25.843123 140736542172096 main.py:82] 6: --batch_size=128
I0105 22:37:25.843196 140736542172096 main.py:82] 7: --input_size=256
I0105 22:37:25.843276 140736542172096 main.py:82] 8: --rnn_hidden_size=256
I0105 22:37:25.843343 140736542172096 main.py:82] 9: --num_epochs=5
I0105 22:37:25.843412 140736542172096 main.py:82] 10: --learning_rate=1e-2
I0105 22:37:25.843482 140736542172096 main.py:82] 11: --train_data_split=train
I0105 22:37:25.843552 140736542172096 main.py:82] 12: --data_dir=./data
I0105 22:37:25.843629 140736542172096 main.py:82] 13: --target_label=death
I0105 22:37:25.843696 140736542172096 main.py:82] 14: --block_size=6
I0105 22:37:25.843765 140736542172096 main.py:82] 15: --history_window=8
I0105 22:37:25.843841 140736542172096 main.py:82] 16: --prediction_window=2
I0105 22:37:25.843911 140736542172096 main.py:82] 17: --train_dataset_size=0
I0105 22:37:25.843983 140736542172096 main.py:82] 18: --rnn_layers=1
I0105 22:37:25.844052 140736542172096 main.py:82] 19: --rnn_dropout=0
I0105 22:37:25.844120 140736542172096 main.py:82] 20: --standardize
I0105 22:37:25.844187 140736542172096 main.py:82] 21: --checkpoint_dir=./experiments
I0105 22:37:25.844254 140736542172096 main.py:82] 22: --experiment_name=death_trial
I0105 22:37:25.844408 140736542172096 main.py:85] Creating dataset...
I0105 22:37:29.925405 140736542172096 dataset.py:115] Number of admissions: 13344
I0105 22:37:29.925858 140736542172096 dataset.py:116] Preprocess dataset with block size of 6
I0105 22:39:16.448971 140736542172096 dataset.py:122] Preprocess completed.
I0105 22:39:16.450680 140736542172096 dataset.py:127] Resample dataset...
I0105 22:39:16.450810 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:39:16.973408 140736542172096 dataset.py:197] Dataset use default size: 4050
I0105 22:39:16.973561 140736542172096 dataset.py:198]   Use all 2025 positive samples
I0105 22:39:16.973626 140736542172096 dataset.py:200]   Randomly choose 2025 negative samples from 425105 candidates
I0105 22:39:17.014900 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:39:40.683962 140736542172096 dataset.py:138] Feature shape for PCA: (13344, 4010)
I0105 22:39:51.568980 140736542172096 main.py:100] Creating dataset completed!
I0105 22:39:51.569146 140736542172096 main.py:102] Creating dataset loader...
I0105 22:39:51.569541 140736542172096 main.py:109] Creating dataset loader completed!
I0105 22:39:51.569607 140736542172096 main.py:111] Creating model for training...
I0105 22:39:51.571824 140736542172096 main.py:124] Creating model for training completed.
I0105 22:39:51.571907 140736542172096 main.py:126] Training dataset size: 4050
I0105 22:39:51.572021 140736542172096 main.py:127] Batches in each epoch: 32
I0105 22:39:51.572545 140736542172096 main.py:135] Model parameters:
I0105 22:39:51.572623 140736542172096 main.py:137] lr_linear.weight: torch.Size([1, 256])
I0105 22:39:51.572695 140736542172096 main.py:137] lr_linear.bias: torch.Size([1])
I0105 22:39:51.597378 140736542172096 main.py:146] Initializatoin complete. Start training.
I0105 22:39:51.597543 140736542172096 dataset.py:127] Resample dataset...
I0105 22:39:51.597641 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:39:52.211971 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:39:54.686815 140736542172096 main.py:176] Epoch [1/5], Step [10/32], Loss: 0.700214, Speed: 1.9333 ms
I0105 22:39:56.946353 140736542172096 main.py:176] Epoch [1/5], Step [20/32], Loss: 0.644611, Speed: 1.7651 ms
I0105 22:39:59.379209 140736542172096 main.py:176] Epoch [1/5], Step [30/32], Loss: 0.665514, Speed: 1.9005 ms
I0105 22:39:59.765765 140736542172096 utilities.py:22] ==================================================
I0105 22:39:59.775604 140736542172096 utilities.py:51] Name: epoch1
I0105 22:39:59.776007 140736542172096 utilities.py:52] Total: 4050
I0105 22:39:59.776084 140736542172096 utilities.py:53] Correct: 2130
I0105 22:39:59.776379 140736542172096 utilities.py:54] Accuracy: 0.5259
I0105 22:39:59.776684 140736542172096 utilities.py:55] F1 Score: 0.1601
I0105 22:39:59.776753 140736542172096 utilities.py:56] ROC AUC Score: 0.6046
I0105 22:39:59.776820 140736542172096 utilities.py:57] Average Precision: 0.5995
I0105 22:39:59.778618 140736542172096 utilities.py:65] Classification Report:
             precision    recall  f1-score   support

   negative     0.5139    0.9615    0.6698      2025
   positive     0.7011    0.0904    0.1601      2025

avg / total     0.6075    0.5259    0.4149      4050

I0105 22:39:59.778785 140736542172096 utilities.py:66] ==================================================
I0105 22:39:59.778891 140736542172096 main.py:181] Saving model checkpoint...
I0105 22:39:59.781044 140736542172096 dataset.py:127] Resample dataset...
I0105 22:39:59.781162 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:40:00.227859 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:40:02.476416 140736542172096 main.py:176] Epoch [2/5], Step [10/32], Loss: 0.645921, Speed: 1.7563 ms
I0105 22:40:04.720324 140736542172096 main.py:176] Epoch [2/5], Step [20/32], Loss: 0.643584, Speed: 1.7529 ms
I0105 22:40:06.937241 140736542172096 main.py:176] Epoch [2/5], Step [30/32], Loss: 0.646904, Speed: 1.7318 ms
I0105 22:40:07.308128 140736542172096 utilities.py:22] ==================================================
I0105 22:40:07.313560 140736542172096 utilities.py:51] Name: epoch2
I0105 22:40:07.313681 140736542172096 utilities.py:52] Total: 4050
I0105 22:40:07.313754 140736542172096 utilities.py:53] Correct: 2210
I0105 22:40:07.313822 140736542172096 utilities.py:54] Accuracy: 0.5457
I0105 22:40:07.313888 140736542172096 utilities.py:55] F1 Score: 0.1734
I0105 22:40:07.313950 140736542172096 utilities.py:56] ROC AUC Score: 0.7564
I0105 22:40:07.314011 140736542172096 utilities.py:57] Average Precision: 0.7924
I0105 22:40:07.315418 140736542172096 utilities.py:65] Classification Report:
             precision    recall  f1-score   support

   negative     0.5240    0.9960    0.6868      2025
   positive     0.9602    0.0953    0.1734      2025

avg / total     0.7421    0.5457    0.4301      4050

I0105 22:40:07.315506 140736542172096 utilities.py:66] ==================================================
I0105 22:40:07.315578 140736542172096 main.py:181] Saving model checkpoint...
I0105 22:40:07.316250 140736542172096 dataset.py:127] Resample dataset...
I0105 22:40:07.316357 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:40:07.771795 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:40:10.119074 140736542172096 main.py:176] Epoch [3/5], Step [10/32], Loss: 0.638594, Speed: 1.8336 ms
I0105 22:40:12.316066 140736542172096 main.py:176] Epoch [3/5], Step [20/32], Loss: 0.640402, Speed: 1.7151 ms
I0105 22:40:14.531036 140736542172096 main.py:176] Epoch [3/5], Step [30/32], Loss: 0.638169, Speed: 1.7303 ms
I0105 22:40:14.904459 140736542172096 utilities.py:22] ==================================================
I0105 22:40:14.912054 140736542172096 utilities.py:51] Name: epoch3
I0105 22:40:14.912180 140736542172096 utilities.py:52] Total: 4050
I0105 22:40:14.912258 140736542172096 utilities.py:53] Correct: 2252
I0105 22:40:14.912326 140736542172096 utilities.py:54] Accuracy: 0.5560
I0105 22:40:14.912395 140736542172096 utilities.py:55] F1 Score: 0.2079
I0105 22:40:14.912461 140736542172096 utilities.py:56] ROC AUC Score: 0.7975
I0105 22:40:14.912527 140736542172096 utilities.py:57] Average Precision: 0.8263
I0105 22:40:14.914037 140736542172096 utilities.py:65] Classification Report:
             precision    recall  f1-score   support

   negative     0.5298    0.9956    0.6916      2025
   positive     0.9633    0.1165    0.2079      2025

avg / total     0.7465    0.5560    0.4498      4050

I0105 22:40:14.914130 140736542172096 utilities.py:66] ==================================================
I0105 22:40:14.914204 140736542172096 main.py:181] Saving model checkpoint...
I0105 22:40:14.915394 140736542172096 dataset.py:127] Resample dataset...
I0105 22:40:14.915603 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:40:15.356503 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:40:17.573029 140736542172096 main.py:176] Epoch [4/5], Step [10/32], Loss: 0.629493, Speed: 1.7314 ms
I0105 22:40:19.815793 140736542172096 main.py:176] Epoch [4/5], Step [20/32], Loss: 0.634437, Speed: 1.7520 ms
I0105 22:40:22.119692 140736542172096 main.py:176] Epoch [4/5], Step [30/32], Loss: 0.641296, Speed: 1.7996 ms
I0105 22:40:22.479444 140736542172096 utilities.py:22] ==================================================
I0105 22:40:22.485590 140736542172096 utilities.py:51] Name: epoch4
I0105 22:40:22.485700 140736542172096 utilities.py:52] Total: 4050
I0105 22:40:22.485764 140736542172096 utilities.py:53] Correct: 2214
I0105 22:40:22.485839 140736542172096 utilities.py:54] Accuracy: 0.5467
I0105 22:40:22.485925 140736542172096 utilities.py:55] F1 Score: 0.1752
I0105 22:40:22.486006 140736542172096 utilities.py:56] ROC AUC Score: 0.7876
I0105 22:40:22.486093 140736542172096 utilities.py:57] Average Precision: 0.8181
I0105 22:40:22.487957 140736542172096 utilities.py:65] Classification Report:
             precision    recall  f1-score   support

   negative     0.5246    0.9970    0.6874      2025
   positive     0.9701    0.0963    0.1752      2025

avg / total     0.7474    0.5467    0.4313      4050

I0105 22:40:22.488086 140736542172096 utilities.py:66] ==================================================
I0105 22:40:22.488164 140736542172096 main.py:181] Saving model checkpoint...
I0105 22:40:22.488790 140736542172096 dataset.py:127] Resample dataset...
I0105 22:40:22.488876 140736542172096 dataset.py:164] Number of instances in labels: 13344
I0105 22:40:22.966213 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:40:25.690047 140736542172096 main.py:176] Epoch [5/5], Step [10/32], Loss: 0.656455, Speed: 2.1277 ms
I0105 22:40:28.798527 140736542172096 main.py:176] Epoch [5/5], Step [20/32], Loss: 0.643561, Speed: 2.4283 ms
I0105 22:40:31.357496 140736542172096 main.py:176] Epoch [5/5], Step [30/32], Loss: 0.633808, Speed: 1.9990 ms
I0105 22:40:31.730589 140736542172096 utilities.py:22] ==================================================
I0105 22:40:31.736168 140736542172096 utilities.py:51] Name: epoch5
I0105 22:40:31.736285 140736542172096 utilities.py:52] Total: 4050
I0105 22:40:31.736351 140736542172096 utilities.py:53] Correct: 2224
I0105 22:40:31.736428 140736542172096 utilities.py:54] Accuracy: 0.5491
I0105 22:40:31.736487 140736542172096 utilities.py:55] F1 Score: 0.1819
I0105 22:40:31.736541 140736542172096 utilities.py:56] ROC AUC Score: 0.7851
I0105 22:40:31.736593 140736542172096 utilities.py:57] Average Precision: 0.8215
I0105 22:40:31.737882 140736542172096 utilities.py:65] Classification Report:
             precision    recall  f1-score   support

   negative     0.5259    0.9980    0.6888      2025
   positive     0.9807    0.1002    0.1819      2025

avg / total     0.7533    0.5491    0.4354      4050

I0105 22:40:31.737962 140736542172096 utilities.py:66] ==================================================
I0105 22:40:31.738025 140736542172096 main.py:181] Saving model checkpoint...
I0105 22:40:31.738629 140736542172096 main.py:195] Training is terminated.
I0105 22:40:31.741705 140736542172096 main.py:200] Metrics saved at ./experiments/death_trial/train_metrics_5_epochs.joblib.
