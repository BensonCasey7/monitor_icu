FATAL Flags parsing error: Unknown command line flag 'data_split'. Did you mean: data_dir ?
Pass --helpshort or --helpfull to see help on flags.
FATAL Flags parsing error: Unknown command line flag 'test_data_split'. Did you mean: eval_data_split ?
Pass --helpshort or --helpfull to see help on flags.
I0105 22:43:58.545523 140736542172096 main.py:337] Saved model parameters:
I0105 22:43:58.545840 140736542172096 main.py:339] 0: model_type=lr
I0105 22:43:58.545902 140736542172096 main.py:339] 1: input_size=256
I0105 22:43:58.545950 140736542172096 main.py:339] 2: rnn_hidden_size=256
I0105 22:43:58.545997 140736542172096 main.py:339] 3: use_attention=False
I0105 22:43:58.546138 140736542172096 main.py:339] 4: rnn_type=lstm
I0105 22:43:58.546209 140736542172096 main.py:339] 5: rnn_layers=1
I0105 22:43:58.546362 140736542172096 main.py:339] 6: rnn_dropout=0.0
I0105 22:43:58.546434 140736542172096 main.py:339] 7: rnn_bidirectional=False
I0105 22:43:58.546494 140736542172096 main.py:339] 8: standardize=True
I0105 22:43:58.546554 140736542172096 main.py:339] 9: block_size=6
I0105 22:43:58.546612 140736542172096 main.py:339] 10: history_window=8
I0105 22:43:58.546669 140736542172096 main.py:339] 11: prediction_window=2
I0105 22:43:58.546730 140736542172096 main.py:339] 12: target_label=death
I0105 22:43:58.546792 140736542172096 main.py:339] 13: data_dir=./data
I0105 22:43:58.546854 140736542172096 main.py:339] 14: lr_pooling=mean
I0105 22:43:58.546934 140736542172096 main.py:523] Mode: Inference
I0105 22:43:58.547014 140736542172096 main.py:208] 0: code/main.py
I0105 22:43:58.547082 140736542172096 main.py:208] 1: --phase=inference
I0105 22:43:58.547177 140736542172096 main.py:208] 2: --batch_size=128
I0105 22:43:58.547279 140736542172096 main.py:208] 3: --eval_data_split=test
I0105 22:43:58.547386 140736542172096 main.py:208] 4: --eval_dataset_size=0
I0105 22:43:58.547464 140736542172096 main.py:208] 5: --checkpoint_dir=./experiments
I0105 22:43:58.547532 140736542172096 main.py:208] 6: --experiment_name=death_trial
I0105 22:44:00.566543 140736542172096 dataset.py:115] Number of admissions: 4376
I0105 22:44:00.567438 140736542172096 dataset.py:116] Preprocess dataset with block size of 6
I0105 22:44:41.712150 140736542172096 dataset.py:122] Preprocess completed.
I0105 22:44:41.712304 140736542172096 dataset.py:127] Resample dataset...
I0105 22:44:41.712384 140736542172096 dataset.py:164] Number of instances in labels: 4376
I0105 22:44:42.070826 140736542172096 dataset.py:197] Dataset use default size: 1268
I0105 22:44:42.071022 140736542172096 dataset.py:198]   Use all 634 positive samples
I0105 22:44:42.071149 140736542172096 dataset.py:200]   Randomly choose 634 negative samples from 138667 candidates
I0105 22:44:42.081183 140736542172096 dataset.py:129] Resample dataset completed!
I0105 22:44:49.672732 140736542172096 dataset.py:138] Feature shape for PCA: (4376, 4010)
I0105 22:44:49.717052 140736542172096 main.py:249] Total number of checkpoints: 5
I0105 22:44:49.717792 140736542172096 main.py:251] 0: checkpoint_epoch001.model
I0105 22:44:49.718007 140736542172096 main.py:251] 1: checkpoint_epoch002.model
I0105 22:44:49.718091 140736542172096 main.py:251] 2: checkpoint_epoch003.model
I0105 22:44:49.718170 140736542172096 main.py:251] 3: checkpoint_epoch004.model
I0105 22:44:49.718250 140736542172096 main.py:251] 4: checkpoint_epoch005.model
I0105 22:44:49.721135 140736542172096 main.py:258] Load model from: ./experiments/death_trial/checkpoint_epoch001.model
I0105 22:44:49.721812 140736542172096 main.py:262] Initializatoin complete. Start inference.
I0105 22:44:51.409631 140736542172096 main.py:277] Progress: 10 / 10
Traceback (most recent call last):
  File "code/main.py", line 531, in <module>
    app.run(main)
  File "/Users/tianyicui/.local/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/Users/tianyicui/.local/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "code/main.py", line 524, in main
    inference(configs)
  File "code/main.py", line 279, in inference
    utilities.update_metrics(metrics, checkpoint_name, y_true, y_score)
TypeError: update_metrics() missing 3 required positional arguments: 'phase', 'summary_writer', and 'step'
